# План реализации

## Задание 1
- [x] Настройка проекта
  - [x] Express.js
  - [x] Sequelize ORM
  - [x] PostgreSQL

- [x] Миграции
  - [x] Создать миграцию для таблицы users через Umzug
    - id
    - balance (default: 10000)
    - created_at
    - updated_at

- [x] API endpoints для баланса
  - [x] POST /balance/update
    - userId
    - amount
    - Валидация отрицательного баланса
    - Обработка параллельных запросов в реальном времени (без очередей)
  - [x] GET /balance/:userId
    - Получение текущего баланса

- [x] Тестирование
  - [x] Скрипт для отправки 10000 параллельных запросов (снятие по 2 единицы)
  - [x] Проверка успешности 5000 запросов
  - [x] Проверка ошибок для остальных 5000 запросов

## Задание 2

### База данных ✓
- [x] Таблица tasks
  - id
  - name
  - interval
  - function_name
  - is_running
  - running_instance
  - started_at

- [x] Таблица task_history
  - id
  - task_id
  - instance_id
  - started_at
  - finished_at
  - status
  - error

### API endpoints
- [ ] GET /tasks
  - [ ] Статус выполнения каждой задачи
  - [ ] Сервер-исполнитель (instance_id)
  - [ ] Время с момента запуска
  - [ ] Список ожидающих задач
  - [ ] Swagger документация

### Cron Tasks
- [ ] Реализация 10 тестовых задач:
  1. [ ] TestTask1 (каждые 5 минут)
     - [ ] Гарантированное время выполнения 2+ минуты
     - [ ] Логирование процесса
  2. [ ] TestTask2 (каждый час)
     - [ ] Гарантированное время выполнения 2+ минуты
     - [ ] Логирование процесса
  3. [ ] TestTask3 (каждые 10 минут)
     - [ ] Гарантированное время выполнения 2+ минуты
     - [ ] Логирование процесса
  4. [ ] TestTask4 (каждые 6 часов)
     - [ ] Гарантированное время выполнения 2+ минуты
     - [ ] Логирование процесса
  5. [ ] TestTask5 (каждые 15 минут)
     - [ ] Гарантированное время выполнения 2+ минуты
     - [ ] Логирование процесса
  6. [ ] TestTask6 (каждые 30 минут)
     - [ ] Гарантированное время выполнения 2+ минуты
     - [ ] Логирование процесса
  7. [ ] TestTask7 (каждый день)
     - [ ] Гарантированное время выполнения 2+ минуты
     - [ ] Логирование процесса
  8. [ ] TestTask8 (каждые 20 минут)
     - [ ] Гарантированное время выполнения 2+ минуты
     - [ ] Логирование процесса
  9. [ ] TestTask9 (каждые 45 минут)
     - [ ] Гарантированное время выполнения 2+ минуты
     - [ ] Логирование процесса
  10. [ ] TestTask10 (каждые 25 минут)
      - [ ] Гарантированное время выполнения 2+ минуты
      - [ ] Логирование процесса

### Инфраструктура ✓
- [x] Масштабирование приложения
  - [x] Docker Compose с возможностью запуска 5+ инстансов
  - [x] Nginx балансировка

- [x] Дополнительно (не требуется в задании)
  - [x] Prometheus метрики
  - [x] Grafana дашборды
  - [x] Healthcheck endpoints
  - [x] Service discovery

### Тестирование
- [ ] Функциональное тестирование (обязательное)
  - [ ] Проверка равномерного распределения задач
  - [ ] Тест блокировки параллельного запуска
  - [ ] Проверка корректности истории выполнения

- [ ] Дополнительное тестирование (опционально)
  - [ ] Тест восстановления после сбоев
  - [ ] Тест параллельного выполнения задач
  - [ ] Проверка использования ресурсов
  - [ ] Тест масштабирования
